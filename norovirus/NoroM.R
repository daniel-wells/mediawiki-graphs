Noro <- structure(list(Month = structure(c(6L, 7L, 8L, 9L, 10L, 11L, 
12L, 1L, 2L, 3L, 4L, 5L, 6L, 7L, 8L, 9L, 10L, 11L, 12L, 1L, 2L, 
3L, 4L, 5L, 6L, 7L, 8L, 9L, 10L, 11L, 12L, 1L, 2L, 3L, 4L, 5L, 
6L, 7L, 8L, 9L, 10L, 11L, 12L, 1L, 2L, 3L, 4L, 5L, 6L, 7L, 8L, 
9L, 10L, 11L, 12L, 1L, 2L, 3L, 4L, 5L, 6L, 7L, 8L, 9L, 10L, 11L, 
12L, 1L, 2L, 3L, 4L, 5L, 6L, 7L, 8L, 9L, 10L, 11L, 12L, 1L, 2L, 
3L, 4L, 5L, 6L, 7L, 8L, 9L, 10L, 11L, 12L, 1L, 2L, 3L, 4L, 5L, 
6L, 7L, 8L, 9L, 10L, 11L, 12L, 1L, 2L, 3L, 4L, 5L, 6L, 7L, 8L, 
9L, 10L, 11L, 12L, 1L, 2L, 3L, 4L, 5L, 6L, 7L, 8L, 9L, 10L, 11L, 
12L, 1L, 2L, 3L, 4L, 5L, 6L, 7L, 8L, 9L, 10L, 11L, 12L, 1L, 2L, 
3L, 4L, 5L, 6L, 7L, 8L, 9L, 10L, 11L, 12L, 1L, 2L, 3L, 4L, 5L
), .Label = c("Aug", "Sep", "Oct", "Nov", "Dec", "Jan", "Feb", 
"Mar", "Apr", "May", "Jun", "Jul"), class = c("ordered", "factor"
)), Cases = c(200L, 370L, 289L, 277L, 154L, 103L, 72L, 70L, 45L, 
84L, 156L, 102L, 162L, 195L, 343L, 179L, 127L, 69L, 50L, 82L, 
56L, 83L, 132L, 267L, 446L, 103L, 137L, 144L, 276L, 259L, 431L, 
282L, 357L, 820L, 419L, 634L, 464L, 449L, 424L, 357L, 127L, 69L, 
43L, 47L, 72L, 141L, 83L, 51L, 99L, 166L, 386L, 313L, 232L, 205L, 
236L, 73L, 72L, 198L, 451L, 702L, 754L, 449L, 535L, 271L, 164L, 
75L, 28L, 36L, 45L, 79L, 106L, 380L, 585L, 783L, 984L, 469L, 
302L, 217L, 105L, 131L, 120L, 121L, 372L, 422L, 801L, 855L, 699L, 
618L, 278L, 69L, 94L, 124L, 243L, 397L, 774L, 1057L, 1088L, 701L, 
749L, 719L, 354L, 168L, 166L, 96L, 239L, 436L, 756L, 1356L, 1681L, 
1209L, 969L, 562L, 268L, 250L, 183L, 135L, 180L, 338L, 695L, 
1246L, 2626L, 2520L, 2582L, 1091L, 732L, 265L, 133L, 139L, 142L, 
189L, 451L, 906L, 1074L, 1297L, 1578L, 898L, 698L, 481L, 345L, 
179L, 182L, 292L, 497L, 1027L, 1366L, 1946L, 1112L, 1022L, 758L, 
380L, 247L, 142L, 231L, 737L, 1336L, 1568L), Year = c(2000L, 
2000L, 2000L, 2000L, 2000L, 2000L, 2000L, 2000L, 2000L, 2000L, 
2000L, 2000L, 2001L, 2001L, 2001L, 2001L, 2001L, 2001L, 2001L, 
2001L, 2001L, 2001L, 2001L, 2001L, 2002L, 2002L, 2002L, 2002L, 
2002L, 2002L, 2002L, 2002L, 2002L, 2002L, 2002L, 2002L, 2003L, 
2003L, 2003L, 2003L, 2003L, 2003L, 2003L, 2003L, 2003L, 2003L, 
2003L, 2003L, 2004L, 2004L, 2004L, 2004L, 2004L, 2004L, 2004L, 
2004L, 2004L, 2004L, 2004L, 2004L, 2005L, 2005L, 2005L, 2005L, 
2005L, 2005L, 2005L, 2005L, 2005L, 2005L, 2005L, 2005L, 2006L, 
2006L, 2006L, 2006L, 2006L, 2006L, 2006L, 2006L, 2006L, 2006L, 
2006L, 2006L, 2007L, 2007L, 2007L, 2007L, 2007L, 2007L, 2007L, 
2007L, 2007L, 2007L, 2007L, 2007L, 2008L, 2008L, 2008L, 2008L, 
2008L, 2008L, 2008L, 2008L, 2008L, 2008L, 2008L, 2008L, 2009L, 
2009L, 2009L, 2009L, 2009L, 2009L, 2009L, 2009L, 2009L, 2009L, 
2009L, 2009L, 2010L, 2010L, 2010L, 2010L, 2010L, 2010L, 2010L, 
2010L, 2010L, 2010L, 2010L, 2010L, 2011L, 2011L, 2011L, 2011L, 
2011L, 2011L, 2011L, 2011L, 2011L, 2011L, 2011L, 2011L, 2012L, 
2012L, 2012L, 2012L, 2012L, 2012L, 2012L, 2012L, 2012L, 2012L, 
2012L, 2012L), Season = structure(c(1L, 1L, 1L, 1L, 1L, 1L, 1L, 
2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 3L, 3L, 3L, 3L, 
3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 
4L, 4L, 4L, 4L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 
6L, 6L, 6L, 6L, 6L, 6L, 6L, 6L, 6L, 6L, 6L, 6L, 7L, 7L, 7L, 7L, 
7L, 7L, 7L, 7L, 7L, 7L, 7L, 7L, 8L, 8L, 8L, 8L, 8L, 8L, 8L, 8L, 
8L, 8L, 8L, 8L, 9L, 9L, 9L, 9L, 9L, 9L, 9L, 9L, 9L, 9L, 9L, 9L, 
10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 11L, 
11L, 11L, 11L, 11L, 11L, 11L, 11L, 11L, 11L, 11L, 11L, 12L, 12L, 
12L, 12L, 12L, 12L, 12L, 12L, 12L, 12L, 12L, 12L, 13L, 13L, 13L, 
13L, 13L, 13L, 13L, 13L, 13L, 13L, 13L, 13L, 14L, 14L, 14L, 14L, 
14L), .Label = c("1999/2000", "2000/2001", "2001/2002", "2002/2003", 
"2003/2004", "2004/2005", "2005/2006", "2006/2007", "2007/2008", 
"2008/2009", "2009/2010", "2010/2011", "2011/2012", "2012/2013"
), class = "factor")), .Names = c("Month", "Cases", "Year", "Season"
), row.names = c(NA, -156L), class = "data.frame")

library(ggplot2)
library(plyr)

# Set factor levels for Months - so plot in correct order
Noro$Month <- factor(Noro$Month,levels=c("Aug","Sep","Oct","Nov","Dec","Jan","Feb","Mar","Apr","May","Jun","Jul"),ordered=TRUE)

# Calculate Mean and standard deviation for each Month
NoroAnnual <- ddply(Noro, c("Month"), summarise,mean = mean(Cases),sd= sd(Cases),N = length(Cases),se= sd / sqrt(N))

# Plot Mean case per month
ggplot(NoroAnnual, aes(x=Month, y=mean,group=0)) +  geom_ribbon(aes(ymin=mean-sd,ymax=mean+sd),alpha=0.3) + geom_line() + labs(x="Month", y="Mean Cases", title="Mean Norovirus Cases per Month (2000-2011)") + annotate("text", x=3, y=1500, label="Shaded Area: Standard Deviation",size=rel(3)) + theme_minimal() + theme(axis.line = element_line(size = 0.5, linetype = "solid",colour = "black"))

ggsave(file="NoroM.pdf", width=7, height=5)

# Plot all Seasons Cases
# ggplot(data=Noro,aes(x=Month, y=Cases,group=Season, colour=Season)) + geom_line(size=0.5,alpha=0.5) + geom_smooth(aes(group = 1),size=1)